<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>FinFlow</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-512.png" type="image/png" />

  <link rel="stylesheet" href="styles/app.css" />
</head>
<body>
  <div class="app">
    <h1>FinFlow <span class="app-version">• v34</span></h1>
    <div class="subtitle">Inkomen, uitgaven, sparen — automatisch door alle maanden en jaren.</div>

    <div class="tabs">
      <div class="tab active" data-tab="categories">Categorieën</div>
      <div class="tab" data-tab="month">Maand</div>
      <div class="tab" data-tab="year">Jaar</div>
    </div>

    <!-- CATEGORIEËN TAB -->
    <div id="tab-categories">
      <button id="newCat" class="add-btn">+ Nieuwe categorie toevoegen</button>
      <div id="catList"></div>
    </div>

    <!-- MAAND TAB -->
    <div id="tab-month" class="hidden">
      <div class="month-header">
        <button id="monthPrev" class="nav-btn">&lt;</button>
        <div class="month-title" id="monthTitle"></div>
        <button id="monthNext" class="nav-btn">&gt;</button>
      </div>

      <div id="monthCategories"></div>

      <div class="card spaar-row">
        <div class="card-header">
          <div class="card-left">
            <div class="tag-savings">SPAARACTIES IN DEZE MAAND</div>
          </div>
          <button id="addSavingAction" class="small-btn">+ Spaaractie</button>
        </div>

        <!-- Inline spaaractieformulier -->
        <div id="savingForm" class="saving-form hidden">
          <div class="saving-input-row">
            <input id="savingAmountInput" class="inline-input" placeholder="Bedrag" />
            <div class="saving-toggle-group">
              <button id="savingToggleDeposit" class="toggle-saving">Storting</button>
              <button id="savingToggleWithdrawal" class="toggle-saving">Opname</button>
            </div>
          </div>
          <div class="btn-row saving-actions">
            <button id="saveSavingBtn" class="primary-btn">Opslaan</button>
            <button id="cancelSavingBtn" class="secondary-btn">Annuleren</button>
          </div>
        </div>

        <div id="savingsList"></div>
      </div>

      <div class="card">
        <div class="section-title">Samenvatting maand</div>
        <div class="summary-row">
          <div class="summary-label">Totaal inkomen</div>
          <div class="summary-value good" id="sumIncome"></div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Totaal uitgaven</div>
          <div class="summary-value bad" id="sumExpense"></div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Beschikbaar</div>
          <div class="summary-value neutral" id="sumAvailable"></div>
        </div>
      </div>
    </div>

    <!-- JAAR TAB -->
    <div id="tab-year" class="hidden">
      <div class="year-nav">
        <button id="prevYearBtn" class="icon-btn">
          <svg viewBox="0 0 24 24" width="18" height="18">
            <path fill="currentColor" d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
        </button>
        <div id="yearTitle" class="year-title"></div>
        <button id="nextYearBtn" class="icon-btn">
          <svg viewBox="0 0 24 24" width="18" height="18">
            <path fill="currentColor" d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"/>
          </svg>
        </button>
      </div>

      <div class="settings-card">
        <div style="font-size:12px; color:#a4a7c4; margin-bottom:4px;">
          Deze waarden worden gebruikt als start voor bank- en spaarrekening in dit jaar.
        </div>

        <div style="display:flex; gap:10px; align-items:center; margin-top:8px;">
          <input id="startingBankInput"
            style="flex:1; padding:8px 10px; height:36px; border:none; border-radius:8px;
                   background:#191b30; color:white; box-sizing:border-box;"
            placeholder="Beginsaldo bankrekening (leeg = 0)">
        </div>

        <div style="display:flex; gap:10px; align-items:center; margin-top:8px;">
          <input id="startingSavingsInput"
            style="flex:1; padding:8px 10px; height:36px; border:none; border-radius:8px;
                   background:#191b30; color:white; box-sizing:border-box;"
            placeholder="Beginsaldo spaarrekening (leeg = 0)">
        </div>

        <div class="year-saving-row">
          <input id="monthlySavingAmount"
            placeholder="Maandelijks sparen (leeg = 0)"
            class="year-saving-input">
          <div class="year-saving-toggle-group">
            <button id="yearToggleDeposit"
              class="year-saving-toggle">
              Storting
            </button>
            <button id="yearToggleWithdrawal"
              class="year-saving-toggle">
              Opname
            </button>
          </div>
        </div>

        <button id="saveSettingsBtn" class="save-settings-btn">Instellingen opslaan</button>
        <div class="section-title" style="margin-top:14px;">Backup</div>
        <div class="info-text">Exporteer of importeer al je FinFlow-gegevens (categorieën, maanddata, instellingen).</div>
        <div style="display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;">
          <button id="exportDataBtn" class="small-btn" style="flex:1; text-align:center;">
            Data exporteren
          </button>
          <button id="importDataBtn" class="small-btn" style="flex:1; text-align:center;">
            Data importeren
          </button>
          <input type="file" id="importFileInput" accept="application/json" style="display:none;">
        </div>
      </div>

      <div class="card">
        <table class="year-grid" id="yearTable">
          <thead>
            <tr>
              <th>Maand</th>
              <th>Inkomen</th>
              <th>Uitgaven</th>
              <th>Storting spaar</th>
              <th>Eindsaldo bank</th>
              <th>Eindsaldo spaar</th>
            </tr>
          </thead>
          <tbody id="yearTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- CATEGORIE-SHEET -->
  <div id="sheetOverlay" class="overlay">
    <div id="sheetForm" class="sheet">
      <h2 id="sheetTitle">Categorie</h2>

      <input id="nameInput" placeholder="Naam" />

      <div style="display:flex; gap:10px; margin-top:8px;">
        <span class="euro-label">€</span>
        <input id="amountInput" placeholder="Standaard maandbedrag" style="flex:1;" />

        <div class="toggle-row">
          <button id="catToggleExpense">Uitgave</button>
          <button id="catToggleIncome">Inkomen</button>
        </div>
      </div>

      <input type="hidden" id="typeInput" value="expense" />

      <div class="startyear-row">
        <span class="startyear-label">Startjaar</span>
        <input id="catStartYear" type="number" />
      </div>

      <button id="sheetSave" class="sheet-btn">Opslaan</button>
      <button id="sheetClose" class="close-btn">Sluiten</button>
    </div>
  </div>


  <script>
    window.onerror = function(msg, src, line, col, err) {
      alert("JS ERROR: " + msg);
    };
  </script>

  <script type="module" src="scripts/main.js"></script>
</body>
</html>
